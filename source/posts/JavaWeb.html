<!-- /*
 * @Author: jaikchen 
 * @Date: 2021-10-26 15:59:48 
 * @Last Modified by:   jaikchen 
 * @Last Modified time: 2021-10-26 15:59:48 
 */ -->
 <!DOCTYPE html>
 <html lang="en">
 <head>
     <meta charset="UTF-8">
     <meta http-equiv="X-UA-Compatible" content="IE=edge">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>一悲自留地</title>
     <link rel="stylesheet" href="../css/base.css">
     <link rel="stylesheet" href="../css/common.css">
     <link rel="stylesheet" href="../css/tcs.css">
     <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/jaikchen/JaikImage/tubiao.ico">
     <style>
         #nav {
             opacity: 1
         }
 
         .justified-gallery img {
             opacity: 1
         }
 
         #post-meta time,
         #recent-posts time {
             display: inline !important
         }
     </style>
 </head>
 <body>
     <div id="web_bg"></div>   
     <div class="page" id="body-wrap">
         <header class="not-top-img" id="page-header">
             <nav id="nav">
                 <span id="blog_name">
                     <a id="site-name" href="">一悲のBlog</a>
                 </span>
                 <span id="blog_name">
                     <a id="site-name" href="">一悲のBlog</a>
                 </span>
                 <span id="blog_name">
                     <a id="site-name" href="">一悲のBlog</a>
                 </span>
             </nav>
         </header>
         <main class="layout" id="content-inner">
             <div class="recent-posts" id="recent-posts">
                <p>你的分数为：</p>
        <span id="span">0</span>
        <span id="G"></span>
    <canvas id="huabu" width="600px" height="600px"></canvas>

    <script>
        let G=document.getElementById('G');
        let span=document.getElementById('span');
        let sum=0;
        // 获取画布对象
        let huabu=document.getElementById('huabu');
        // 取出绘制工具
        let tools=huabu.getContext('2d');
        //moveTo（x，y）起始点坐标
        //lineTo（x，y）终点坐标


        //食物的默认位置：
        //取1-19的随机数+向下取整
        let x=Math.floor(Math.random()*20);
        let y=Math.floor(Math.random()*20);
        //没被吃的时候食物不动
        let isflag=false;


        //蛇的默认位置
        let snake=[{x:3,y:0},{x:2,y:0},{x:1,y:0}];


        //监听案件
        let directionX=1,directionY=0;
        document.addEventListener('keydown',function(even){
            if((event.keyCode===38||event.keyCode===87||event.keyCode===104)&&directionY!=1)
            {
                console.log('上');
                directionX=0;
                directionY=-1;
            }
            else if((event.keyCode===40||event.keyCode===83||event.keyCode===98)&&directionY!=-1)
            {
                console.log('下');
                directionX=0;
                directionY=1;
            }
            else if((event.keyCode===37||event.keyCode===65||event.keyCode===100)&&directionX!=1)
            {
                console.log('左');
                directionX=-1;
                directionY=0;
            }
            else if((event.keyCode===39||event.keyCode===68||event.keyCode===102)&&directionX!=-1)
            {
                console.log('右');
                directionX=1;
                directionY=0;
            }
        })

        let game=false;
        for(let i=1;i<snake.length;i++)
        {
            if(snake[0].x===snake[i].x&&snake[0].y===snake[i].y)
                game=true;
        }


        //定时器->擦除+重绘------------------------------------------
        setInterval(function(){
            for(let i=1;i<snake.length;i++)
        {
            if(snake[0].x===snake[i].x&&snake[0].y===snake[i].y)
                game=true;
        }
            if(game===true)
            {
                G.textContent="Game Over";
                return;
            }
    //---------------------*擦除*----------------------
        tools.clearRect(0,0,600,600);

    //---------------------*绘制*----------------------
    
    //判断蛇头是否吃到了食物：
    if(snake[0].x===x&&snake[0].y===y)
        {
            isflag=true;
        }else{
            snake.pop();
        }


    //随机出现的食物：
        if(isflag)
        {
            x=Math.floor(Math.random()*20);
            y=Math.floor(Math.random()*20);
            isflag=false;
            sum++;
        }
        /*绘制矩形
        设置填充的颜色值*/
        tools.fillStyle='red';
        tools.fillRect(x*30,y*30,30,30);
        

    //画出蛇
    //1.随着重绘让蛇动起来
    //2.初始方向为水平向右
    //3.默认每次移动距离为一格

    //只需要每次重绘的时候改变坐标即可使贪吃蛇动起来
    //只需要删除最后一节，然后新建一节添加到数组中即可
    //z[].pop()：删除最后一个元素  unshift()：在数组第一个元素前添加新的元素
    
        let oldhead=snake[0];
        let newhead={x:oldhead.x+directionX,y:oldhead.y+directionY}
        snake.unshift(newhead);

        
        for(let i=0;i<snake.length;i++)
        {
            if(i==0)
                tools.fillStyle='pink';
            else
                tools.fillStyle='yellow';
            if(snake[i].x>19)
                snake[i].x=0;
            else if(snake[i].x<0)
                snake[i].x=19;
            else if(snake[i].y>19)
                snake[i].y=0;
            else if(snake[i].y<0)
                snake[i].y=19;
            tools.fillRect(snake[i].x*30,snake[i].y*30,30,30);
        };
        
        

    //画出网格线
        //横线
        for(var i=1;i<=19;i++)
        {
            tools.moveTo(0,30*i+0.5);
            tools.lineTo(600,30*i+0.5);
        }
        //竖线
        for(var i=1;i<=19;i++)
        {
            tools.moveTo(30*i+0.5,0);
            tools.lineTo(30*i+0.5,600);
        }
        tools.strokeStyle='white';
        tools.stroke();

        span.textContent=sum;
    },1000/8);//一秒重绘三次
    </script>
             </div>
             <div class="aside-content" id="aside-content">
                 <div class="card-widget card-info">
                     <div class="is-center">
                         <div class="avatar-img"><img
                                 src="https://cdn.jsdelivr.net/gh/jaikchen/JaikImage/head.jpg"
                                 onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div>
                         <div class="author-info__name">一悲先生</div>
                         <div class="">
                             夏天涌起橙味的海浪<br>
                             黄昏在落幕时降临<br>
                             哪里需要天地熄灭光亮<br>
                             分明宇宙无限,灯火通明
                         </div>
                     </div>
                     <div class="card-info-data">
                         <div class="card-info-data-item is-center"><a href="/archives/">
                                 <div class="headline">文章</div>
                                 <div class="length-num">73</div>
                             </a></div>
                         <div class="card-info-data-item is-center"><a href="/tags/">
                                 <div class="headline">标签</div>
                                 <div class="length-num">51</div>
                             </a></div>
                         <div class="card-info-data-item is-center"><a href="/categories/">
                                 <div class="headline">分类</div>
                                 <div class="length-num">5</div>
                             </a></div>
                     </div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener"
                         href="https://github.com/JaikChen"><i class="fab fa-github"></i><span>GitHub</span></a>
                 </div>
                 <div class="card-widget card-announcement">
                     <div class="item-headline"><i
                             class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div>
                             <div class="announcement_content"><img src="https://readme-typing-svg.herokuapp.com?color=%234C4948&lines=%E8%BF%99%E6%98%AF%E4%B8%BA%E5%89%8D%E7%AB%AF%E8%AF%BE%E8%AE%BE%E8%80%8C%E5%86%99%E7%9A%84%E7%AE%80%E5%8C%96%E7%89%88blog;%E5%A6%82%E6%9E%9C%E9%9C%80%E8%A6%81%2C%E8%BF%98%E8%AF%B7%E5%8F%82%E8%A7%82%E7%9C%9F%E5%AE%9E%E7%9A%84%E8%87%AA%E7%95%99%E5%9C%B0" alt=""><br></div>
                    </div>
                     <div class="card-widget card-categories">
                         <div class="item-headline"><i class="fas fa-folder-open"></i> <span>分类</span></div>
                         <ul class="card-category-list" id="aside-cat-list">
                             <li class="card-category-list-item"><a class="card-category-list-link"
                                     href=""><span
                                         class="card-category-list-name">学习记录</span><span
                                         class="card-category-list-count">19</span></a></li>
                             <li class="card-category-list-item"><a class="card-category-list-link"
                                     href=""><span
                                         class="card-category-list-name">干货分享</span><span
                                         class="card-category-list-count">11</span></a></li>
                             <li class="card-category-list-item"><a class="card-category-list-link"
                                     href=""><span
                                         class="card-category-list-name">技巧杂烩</span><span
                                         class="card-category-list-count">20</span></a></li>
                             <li class="card-category-list-item"><a class="card-category-list-link"
                                     href=""><span
                                         class="card-category-list-name">无处安放</span><span
                                         class="card-category-list-count">2</span></a></li>
                             <li class="card-category-list-item"><a class="card-category-list-link"
                                     href=""><span
                                         class="card-category-list-name">生活随笔</span><span
                                         class="card-category-list-count">2122</span></a></li>
                         </ul>
                     </div>
                 </div>
             </div>
         </main>
     </div>
 </body>
 </html>